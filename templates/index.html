{% extends "base.html" %}

{% block content %}
    
    <p class="subtitle">Encontre itens comprados por órgãos públicos via PNCP.</p>

    <form id="filtro-form">
        <div class="form-group">
            <label for="cnpj">CNPJ do Órgão:</label>
            <input type="text" id="cnpj" name="cnpj" value="13825484000150" required>
        </div>
        <div class="form-group">
            <label for="data_inicio">Data Início:</label>
            <input type="date" id="data_inicio" name="data_inicio" required>
        </div>
        <div class="form-group">
            <label for="data_fim">Data Fim:</label>
            <input type="date" id="data_fim" name="data_fim" required>
        </div>
        <button type="submit" id="btn-buscar">Buscar Itens</button>
    </form>

    <div id="loading" class="hidden">
        <div class="spinner"></div>
        Buscando dados no PNCP... Isso pode levar um minuto.
    </div>
    <div id="status-message"></div>

    <div id="resultados-container">
        </div>
    
{% endblock %}


{% block scripts %}
    <script src="{{ url_for('static', filename='app.js') }}"></script>
{% endblock %}

{% block after_main %}
<div id="contribution-modal" class="modal-overlay hidden" style="display: none;">
    <div class="modal-content">
        <span class="modal-close-btn">&times;</span>
        <h3>Contribuir com Análise de Preço</h3>
        <p>Você está avaliando o item: <strong id="modal-item-descricao">...</strong></p>
        
        <form id="contribution-form">
            <input type="hidden" id="modal-item-key" name="item_key">
            <input type="hidden" id="modal-item-status" name="status">
            
            <div class="form-group-stacked">
                <label for="modal-link">Link de Referência (Obrigatório)</label>
                <input type="url" id="modal-link" name="link" class="form-control" placeholder="https://www.exemplo.com/produto" required>
            </div>
            
            <div class="form-group-stacked">
                <label for="modal-comment">Comentário (Opcional)</label>
                <textarea id="modal-comment" name="comment" class="form-control" rows="3" placeholder="Ex: Este preço é para um kit com 10, não para a unidade."></textarea>
            </div>
            
            <button type="submit" id="modal-submit" class="btn-submit">Enviar Contribuição</button>
        </form>
    </div>
</div>
{% endblock %}